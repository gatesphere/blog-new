<!DOCTYPE html><html><head><meta charset="utf-8"/><link href="http://feeds.feedburner.com/suspended-chord/blog" rel="alternate" title="a-&gt;ab" type="application/rss+xml"/><link href="https://plus.google.com/114523146530319290209/posts" rel="author"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><link href="/static/assets/packed.css" media="all" rel="stylesheet" type="text/css"/><script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript">
    </script><title>Using Mobile Processing on the BlackBerry | a-&gt;ab</title></head><body><div class="container"><header><h1>a→ab</h1><h2>computation, game design, and experimentation</h2><br/> <a href="/">front page</a> | <a href="/about">about</a> | <a href="/archives">archives</a> | <a href="/code-dump">code dump</a> | <a href="/csmm">c.s. for mere mortals</a> | <a href="/tags">tags</a> | <span class="rss"><a href="http://feeds.feedburner.com/suspended-chord/blog">rss feed</a></span></header><section><div class="column"><article class="post"><header><h1>Using Mobile Processing on the BlackBerry</h1><span class="date">September 12, 2012</span><br/> <span class="tags">tags: <a href="/tag/processing/">processing</a>, <a href="/tag/mobile%20processing/">mobile processing</a>, <a href="/tag/blackberry/">blackberry</a>, <a href="/tag/development/">development</a>, <a href="/tag/rim/">rim</a></span></header><section class="content"><p>Hello all,</p><p>I recently was able to get <a href="http://mobile.processing.org/">Mobile Processing</a> working for Java development on the BlackBerry plug-in for Eclipse, and it works wonderfully. I thought I'd share my process for anyone who is interested. It even works intermingled with the BlackBerry API, aside from the UI classes.</p><h2>What you need</h2><p>To do this, you will need the following:</p><ul><li>A copy of Eclipse with the <a href="https://developer.blackberry.com/java/download/eclipse">Java BlackBerry Plug-in</a> installed</li><li>A copy of <a href="http://mobile.processing.org/download/index.php">Mobile Processing</a></li></ul><p>That's it. No need to download the WTK/CLDC, or JavaME, etc.</p><p>Using the following steps, you can create a project that uses Mobile Processing targeting the BlackBerry.</p><h2>Preliminaries</h2><p>First, extract the Mobile Processing archive you downloaded. Find the lib/ directory with all the .jars, and save it somewhere you know you'll be able to find it later. This is where the core of Mobile Processing lives.</p><h2>Make a new project</h2><p>From within Eclipse, do: File -&gt; New -&gt; New Project. Select BlackBerry Project and click Next &gt;. On the next screen, give it a name, and choose the JRE for the OS level you are targeting, and click Next &gt;. On this next screen, click on the Libraries tab up top, then click Add External JARs, navigate to the lib/ directory you saved earlier, and select mobile.jar. Now click on the Order and Export tab up top, and make sure the checkbox next to mobile.jar is checked (it most likely is not by default). Click Next &gt; again, then select Empty Application, and click Next &gt;. Give it a package name and a class name, and click Finish.</p><h2>Configuration of the project</h2><p>Open up the BlackBerry_App_Descriptor.xml file for your newly created project. Give it a proper title, version, vendor, and description. Under Application type, select MIDlet. Then type the fully-qualified name of your app's main class (i.e. suschord.processingtest.HelloWorld). Save.</p><h2>Code!</h2><p>To use the Mobile Processing API in your project, your main app class has to <code>import processing.core.PMIDlet;</code>, and also be declared that it <code>extends PMIDlet</code>. You should get rid of any <code>main()</code> function... it cannot be used here, <code>PMIDlet</code> includes a <code>main()</code> that does all the right things. You should create at least two functions, <code>public void setup()</code> and <code>public void draw()</code>.</p><p>At this point, you have a working Mobile Processing sketch. Any code you place inside your main app class will work exactly as if you were coding a Mobile Processing sketch.</p><p>Here's an example of an application that draws lines from the center of the screen to random points across the screen, in random colors.</p><div class="codehilite"><pre><span class="n">package</span> <span class="n">suschord</span><span class="p">.</span><span class="n">processingtest</span><span class="p">;</span>

<span class="n">import</span> <span class="n">processing</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">PMIDlet</span><span class="p">;</span>

<span class="n">public</span> <span class="n">class</span> <span class="n">HelloWorld</span> <span class="n">extends</span> <span class="n">PMIDlet</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">white</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">center_x</span><span class="p">,</span> <span class="n">center_y</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">linecolor</span><span class="p">;</span>

  <span class="n">public</span> <span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">white</span> <span class="o">=</span> <span class="n">color</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span>
    <span class="n">background</span><span class="p">(</span><span class="n">white</span><span class="p">);</span>
    <span class="n">center_x</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">center_y</span> <span class="o">=</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">framerate</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">public</span> <span class="kt">void</span> <span class="nf">draw</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">linecolor</span> <span class="o">=</span> <span class="n">randcolor</span><span class="p">();</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">randx</span><span class="p">();</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">randy</span><span class="p">();</span>
    <span class="n">stroke</span><span class="p">(</span><span class="n">linecolor</span><span class="p">);</span>
    <span class="n">line</span><span class="p">(</span><span class="n">center_x</span><span class="p">,</span> <span class="n">center_y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="nf">randcolor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">color</span><span class="p">(</span><span class="n">random</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span> <span class="n">random</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span> <span class="n">random</span><span class="p">(</span><span class="mi">255</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="nf">randx</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">random</span><span class="p">(</span><span class="n">width</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="nf">randy</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">random</span><span class="p">(</span><span class="n">height</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div><p>The method definitions <code>randcolor()</code>, <code>randx()</code>, and <code>randy()</code> are unnecessary, but I thought I'd throw them in to demonstrate that methods work the same way here as they do in Mobile Processing.</p><h2>Making it Exciting</h2><p>Now that you have a Mobile Processing sketch running on your BlackBerry, it's time to start working the RIM API to talk with the BlackBerry device.</p><p>Here's an example which uses accelerometer data to determine the colors of the lines from the previous example:</p><div class="codehilite"><pre><span class="n">package</span> <span class="n">suschord</span><span class="p">.</span><span class="n">processingtest</span><span class="p">;</span>

<span class="n">import</span> <span class="n">net</span><span class="p">.</span><span class="n">rim</span><span class="p">.</span><span class="n">device</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">system</span><span class="p">.</span><span class="n">AccelerometerSensor</span><span class="p">;</span>
<span class="n">import</span> <span class="n">net</span><span class="p">.</span><span class="n">rim</span><span class="p">.</span><span class="n">device</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">system</span><span class="p">.</span><span class="n">Application</span><span class="p">;</span>
<span class="n">import</span> <span class="n">processing</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">PMIDlet</span><span class="p">;</span>

<span class="n">public</span> <span class="n">class</span> <span class="n">HelloWorld</span> <span class="n">extends</span> <span class="n">PMIDlet</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">white</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">center_x</span><span class="p">,</span> <span class="n">center_y</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">linecolor</span><span class="p">;</span>
  <span class="n">AccelerometerSensor</span><span class="p">.</span><span class="n">Channel</span> <span class="n">accl</span><span class="p">;</span>
  <span class="kt">short</span><span class="p">[]</span> <span class="n">xyz</span> <span class="o">=</span> <span class="n">new</span> <span class="kt">short</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>

  <span class="n">public</span> <span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">accl</span> <span class="o">=</span> <span class="n">AccelerometerSensor</span><span class="p">.</span><span class="n">openRawDataChannel</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="n">getApplication</span><span class="p">());</span>
    <span class="n">white</span> <span class="o">=</span> <span class="n">color</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span>
    <span class="n">background</span><span class="p">(</span><span class="n">white</span><span class="p">);</span>
    <span class="n">center_x</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">center_y</span> <span class="o">=</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">framerate</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">public</span> <span class="kt">void</span> <span class="nf">draw</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">linecolor</span> <span class="o">=</span> <span class="n">accelcolor</span><span class="p">();</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">randx</span><span class="p">();</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">randy</span><span class="p">();</span>
    <span class="n">stroke</span><span class="p">(</span><span class="n">linecolor</span><span class="p">);</span>
    <span class="n">line</span><span class="p">(</span><span class="n">center_x</span><span class="p">,</span> <span class="n">center_y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">accl</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="nf">accelcolor</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">accl</span><span class="p">.</span><span class="n">getLastAccelerationData</span><span class="p">(</span><span class="n">xyz</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">color</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="nf">randx</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">random</span><span class="p">(</span><span class="n">width</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="nf">randy</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">random</span><span class="p">(</span><span class="n">height</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div><p>From my tests, this works with most of the RIM API, aside from the UI classes. Even code that needs to be signed works. There are some caveats with using Mobile Processing, though. One major issue is that MIDlets cannot automatically start when the device does. I'm looking for a workaround for this, or a way to compile and deploy as a native app. Time will tell if I can make this work, however. Future posts will explain how to listen for keyboard/trackball events, touchscreen events, etc.</p><p>Thanks for reading!</p></section><section class="comments"><div id="disqus_thread"></div><script src="http://disqus.com/forums/suschord/embed.js" type="text/javascript"> </script><noscript>&lt;a href="http://suschord.disqus.com/?url=ref"&gt;View the discussion thread.&lt;/a&gt;</noscript><a class="dsq-brlink" href="http://disqus.com">blog comments powered by <span class="logo-disqus">Disqus</span></a></section></article></div></section><footer>a→ab is the blog of Jake Peck, also known as <a href="http://suspended-chord.info/">suspended-chord</a></footer><script type="text/javascript">
var disqus_shortname = 'suschord';
(function () {
  var s = document.createElement('script'); s.async = true;
  s.src = 'http://disqus.com/forums/suschord/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script></div></body></html>